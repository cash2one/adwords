done_urls = [
"www.bookyogaretreats.com/all/c/short/d/europe",
"www.bookyogaretreats.com/all/d/asia-and-oceania/philippines",
"www.bookyogaretreats.com/all/c/holidays/d/asia-and-oceania/india/goa",
"www.bookyogaretreats.com/all/c|/budget-retreats/d/asia-and-oceania",
"www.bookyogaretreats.com/all/d/europe/croatia",
"www.bookyogaretreats.com/all/c/budget-retreats/d/the-americas-and-caribbean/usa",
"www.bookyogaretreats.com/all/c/budget-retreats/d/europe/united-kingdom",
"www.bookyogateachertraining.com/all/s/yoga-vinyasa",
"www.bookyogaretreats.com/all/c/holidays/d/europe",
"www.bookyogaretreats.com/all/c/holidays/d/the-americas-and-caribbean/usa/hawaii",
"www.bookyogaretreats.com/all/c/holidays/d/the-americas-and-caribbean/usa/florida",
"www.bookyogaretreats.com/all/s/vinyasa-yoga",
"www.bookyogaretreats.com/all/c/yoga-detox-retreats",
"www.bookyogaretreats.com/all/d/the-americas-and-caribbean/mexico",
"www.bookyogaretreats.com/all/c/short/d/the-americas-and-caribbean/usa/california",
"www.bookyogateachertraining.com/all/d/europe",
"www.bookyogaretreats.com/all/c/budget-retreats/d/asia-and-oceania/indonesia/bali",
"www.bookyogaretreats.com/?arrival_date=2017-02-15&flexible=15",
"www.bookyogaretreats.com/all/c/holidays/d/asia-and-oceania/indonesia",
"www.bookyogaretreats.com/all/c/yoga-meditation-retreats",
"www.bookyogaretreats.com/all/c/holidays/d/asia-and-oceania/india",
"www.bookyogaretreats.com/?arrival_date=2017-03-15&flexible=15",
"www.bookyogaretreats.com/all/c/yoga-meditation-retreats/d/the-americas-and-caribbean/usa/florida",
"www.bookyogaretreats.com/all/c/budget-retreats/d/the-americas-and-caribbean",
"www.bookyogaretreats.com/all/c/yoga-surf/d/the-americas-and-caribbean/costa-rica",
"www.bookyogaretreats.com/?arrival_date=2016-05-15&flexible=15",
"www.bookyogateachertraining.com/all/d/asia-and-oceania/thailand",
"www.bookyogaretreats.com/all/c/short",
"www.bookyogaretreats.com/all/c/short/d/the-americas-and-caribbean/usa",
"www.bookyogaretreats.com/all/s/bikram-hot-yoga",
"www.bookyogaretreats.com/all/d/asia-and-oceania/india",
"www.bookyogaretreats.com/?arrival_date=2016-12-15&flexible=15",
"www.bookyogaretreats.com/all/d/asia-and-oceania/india/goa",
"www.bookyogaretreats.com/all/c/budget-retreats/d/asia-and-oceania/thailand",
"www.bookyogaretreats.com/all/c/beach-retreats/d/the-americas-and-caribbean",
"www.bookyogaretreats.com/all/c/yoga-surf",
"www.bookyogaretreats.com/all/c/budget-retreats",
"www.bookyogaretreats.com/all/d/asia-and-oceania/vietnam",
"www.bookyogaretreats.com/all/c/holidays/d/the-americas-and-caribbean",
"www.bookyogaretreats.com/all/c/holidays/d/europe/united-kingdom",
"www.bookyogaretreats.com/all/d/the-americas-and-caribbean/usa/hawaii",
"www.bookyogaretreats.com/?arrival_date=2016-06-15&flexible=15",
"www.bookyogaretreats.com/all/d/europe/united-kingdom/england",
"www.bookyogaretreats.com/all/c/holidays/d/asia-and-oceania/indonesia/bali",
"www.bookyogaretreats.com/all/d/europe/france",
"www.bookyogaretreats.com/all/c/holidays/d/europe/greece",
"www.bookyogaretreats.com/all/d/europe/greece",
"www.bookyogaretreats.com/?arrival_date=2016-07-15&flexible=15",
"www.bookyogaretreats.com/?arrival_date=2016-10-15&flexible=15",
"www.bookyogaretreats.com/?arrival_date=2016-09-15&flexible=15",
"www.bookyogaretreats.com/all/c/holidays/d/africa-and-the-middle-east/morocco",
"www.bookyogaretreats.com/?arrival_date=2016-11-15&flexible=15",
"www.bookyogaretreats.com/?arrival_date=2017-01-15&flexible=15",
"www.bookyogaretreats.com/all/d/the-americas-and-caribbean",
"www.bookyogaretreats.com/all/d/asia-and-oceania/nepal",
"www.bookyogaretreats.com/all/c/holidays/d/the-americas-and-caribbean/usa/california",
"www.bookyogaretreats.com/all/c/holidays/d/asia-and-oceania/india/kerala",
"www.bookyogaretreats.com/?arrival_date=2016-08-15&flexible=15",
"www.bookyogaretreats.com/all/c/holidays/d/asia-and-oceania/thailand",
"www.bookyogaretreats.com/all/d/asia-and-oceania/cambodia",
"www.bookyogaretreats.com/all/d/europe/spain/ibiza",
"www.bookyogaretreats.com/all/c/short/d/the-americas-and-caribbean",
"www.bookyogaretreats.com/all/d/europe/spain/mallorca",
"www.bookyogaretreats.com/all/d/asia-and-oceania/indonesia/bali",
"www.bookyogaretreats.com/all/c/holidays/d/europe/spain/canary-islands",
"www.bookyogaretreats.com/all/c/yoga-surf/d/asia-and-oceania/indonesia/bali",
"www.bookyogaretreats.com/all/d/europe/spain",
"www.bookyogaretreats.com/all/c/holidays/d/europe/spain",
"www.bookyogaretreats.com/all/c/holidays/d/europe/portugal",
"www.bookyogaretreats.com/all/s/ashtanga-yoga",
"www.bookyogaretreats.com/all/d/asia-and-oceania/india/kerala",
"www.bookyogaretreats.com/all/d/europe/italy",
"www.bookyogaretreats.com/all/c/holidays/d/asia-and-oceania/vietnam",
"www.bookyogaretreats.com/all/d/asia-and-oceania/new-zealand",
"www.bookyogaretreats.com/all/c/holidays/d/the-americas-and-caribbean/usa",
"www.bookyogaretreats.com/all/d/europe",
"www.bookyogaretreats.com/all/d/europe/spain/canary-islands",
"www.bookyogaretreats.com/all/c/holidays/d/europe/spain/ibiza",
"www.bookyogaretreats.com/all/c/holidays/d/asia-and-oceania/sri-lanka",
"www.bookyogaretreats.com/all/c/holidays/d/the-americas-and-caribbean/costa-rica",
"www.bookyogateachertraining.com/",
"www.bookyogaretreats.com/all/d/asia-and-oceania/australia",
"www.bookyogaretreats.com/?arrival_date=2016-04-15&flexible=15",
"www.bookyogaretreats.com/all/d/the-americas-and-caribbean/USA",
"www.bookyogaretreats.com/all/d/europe/portugal",
"www.bookyogaretreats.com/all/d/asia-and-oceania/sri-lanka",
"www.bookyogaretreats.com",
"www.bookyogaretreats.com/all/c/holidays/d/asia-and-oceania/cambodia",
"www.bookyogateachertraining.com/all/d/the-americas-and-caribbean",
"www.bookyogaretreats.com/all/d/africa-and-the-middle-east/morocco",
"www.bookyogaretreats.com/all/d/africa-and-the-middle-east",
"www.bookyogaretreats.com/all/d/the-americas-and-caribbean/costa-rica",
"www.bookyogaretreats.com/all/c/holidays/d/asia-and-oceania/australia",
"www.bookyogaretreats.com/all/d/asia-and-oceania/indonesia",
"www.bookyogateachertraining.com/all/d/the-americas-and-caribbean/costa-rica",
"www.bookyogaretreats.com/all/d/europe/united-kingdom",
"www.bookyogaretreats.com/all/d/asia-and-oceania/thailand",
"www.bookyogaretreats.com/all/d/asia-and-oceania"
]

import csv
import codecs

file_name = '20160712.csv'

basic_dict = {} 
ready_dict = {}
ready_dict_names = {}
state_country = {}

names = []
ready_names = []
ready_urls = []
ready_ids = []

#setup basic_dict (everything)
#ready_urls (only ones without adgroups)
#ready_ids (only ones without adgroups)

with codecs.open(file_name, 'r', encoding = 'utf-8', errors = 'ignore') as csvfile:
    reader=csv.DictReader(csvfile)
    for row in reader:
        names.append(row['name'])
        basic_dict[int(row['destination_id'])] = row['name']
        if row['concat'] not in done_urls: #only for urls that do not have adgroups yet
            ready_urls.append(row['concat']) #add all urls
            ready_ids.append(int(row['destination_id']))
            ready_names.append(row['name'])

#setup ready_dict 
#['key'] = destination_id
#ready_dict['key'][0] = destination name
#ready_dict['key'][1] = destination type
#ready_dict['key'][2] = number of listings
#ready_dict['key'][3] = URL (landing page)
#ready_dict['key'][4] = country name
#ready_dict['key'][5] = destination slug
#ready_dict['key'][6] = parent slug

with codecs.open(file_name, 'r', encoding = 'utf-8', errors = 'ignore') as csvfile:
    reader=csv.DictReader(csvfile)
    for row in reader:
        if row['concat'] not in done_urls:
            ready_dict[int(row['destination_id'])] = [row['name'], row['type1'], int(row['nr_listings']), row['concat'], basic_dict[int(row['parent_id1'])], row['slug1'], row['slug2'], row['name2'], 'in '+ row['name']]
            ready_dict_names[row['slug1']] = [row['name'], row['type1']]

#prepare text ads

headline1 = []
headline2 = []

desc11 = []
desc12 = []

desc21 = []
desc22 = []

display_url = []
final_url = []

campaign = []
ad_group = []

#ad_state
#device_preference
#ad_type

for i in range(len(ready_ids)):
    headline1.append('Book Yoga Retreats Online')
    headline2.append('Best Yoga Retreats 2016')
    
    desc11.append('%s Deals in %s!' %(ready_dict[ready_ids[i]][2], ready_dict[ready_ids[i]][0]))
    desc12.append('Top Rated & Best Price Guarantee')
    
    desc21.append('%s Deals in %s!' %(ready_dict[ready_ids[i]][2], ready_dict[ready_ids[i]][0]))
    desc22.append('Compare and Book from Top Packages')
    
    display_url.append('www.BookYogaRetreats.com/%s' %ready_dict[ready_ids[i]][5].title())
    final_url.append(ready_dict[ready_ids[i]][3])

    ad_group.append('Longtail Retreats %s' %ready_dict[ready_ids[i]][0])

for i in range(len(ready_ids)):
    if ready_dict[ready_ids[i]][1] == 'country':
        campaign.append("Longtail %s" %ready_dict[ready_ids[i]][0])
    if ready_dict[ready_ids[i]][1] == 'state':
        campaign.append("Longtail %s - %s" %(ready_dict[ready_ids[i]][4], ready_dict[ready_ids[i]][0]))
    
for i in range(len(ad_group)):
    ad_group[i] = ad_group[i].replace("  ", " ")
    campaign[i] = campaign[i].replace("  ", " ")

for i in range(len(display_url)):
    display_url[i] = display_url[i].replace('-', '')
    if len(display_url[i]) > 35:
        display_url[i] = 'www.BookYogaRetreats.com'

for item in headline1:
    if len(item) > 25:
        print(item)
        
for item in headline2:
    if len(item) > 25:
        print(item)

for i in range(len(desc11)):
    if len(desc11[i]) > 38:
        desc11[i] = ''.join([i for i in desc11[i] if not i.isdigit()])
        desc11[i] = desc11[i].replace(' Deals', 'Deals')
        if len(desc11[i]) > 38:
            desc11[i] = desc11[i].replace("Deals in ", '')

for i in range(len(desc11)):
    if len(desc11[i]) > 38:
        print(desc11[i], len(desc11[i]))
    
for i in range(len(desc21)):
    if len(desc21[i]) > 38:
        desc21[i] = ''.join(i for i in desc21[i] if not i.isdigit())
        desc21[i] = desc21[i].replace(' Deals', 'Deals')
        if len(desc21[i]) > 38:
            desc21[i] = desc21[i].replace('Deals in ', '')
            
for i in range(len(desc21)):
    if len(desc21[i]) > 38:
        print(desc21[i], len(desc21[i]))

headlines = (headline1 + headline2) * 2
d1 = (desc11 + desc21) * 2
d2 = (desc12 + desc22) * 2

display_url = display_url * 4
final_url = final_url * 4
campaign = campaign * 4
ad_group = ad_group * 4

how_many_ads = len(headlines)

ad_state = ['enabled'] * how_many_ads
ad_type = ['Text ad'] * how_many_ads

dev_all = ['All'] * int(how_many_ads/2)
dev_mobile = ['Mobile'] * int(how_many_ads/2)
dev_pref = dev_all + dev_mobile 


ad_column_titles = ["Ad state",
                    "Ad",
                    "Description line 1",
                    "Description line 2",
                    "Display URL",
                    "Final URL",
                    "Device preference type",
                    "Campaign",
                    "Ad group",
                    "Ad type"] 

ad_rows = []

for i in range(how_many_ads):
    ad_rows.append(
        [ad_state[i],
        headlines[i],
        d1[i],
        d2[i],
        display_url[i],
        final_url[i],
        dev_pref[i],
        campaign[i],
        ad_group[i],
        ad_type[i]])        

export_name = 'SQL Ads.csv'
new_export = open(export_name, 'w')
export_object = csv.writer(new_export)

export_object.writerow(ad_column_titles)
export_object.writerows(ad_rows)

new_export.close()

print('%i ads for %i destinations have been created (4 ads per destination: 2 for mobile, 2 for desktop) please check your current directory for the csv output' %(len(d1), len(ready_urls)))

yoga = ['yoga']
        
holiday_word1 = [
'training',
'trainings', 
'retreat',  
'retreats', 
'vacation',
'vacations',
'resort',
'resorts',
'camp',
'camps',
'package',
'packages',
'center',
'centers',
'centre',
'centres',
'deal',
'deals']

holiday_word2 = [
'package',
'packages',
'resort',
'resorts',
'retreat',
'retreats',
'deal',
'deals',
'']

destination_front = []
destination_back= []

# for i in range(len(ready_ids)):
#     destination_front.append(ready_dict[ready_ids[i]][0])
#     destination_back.append(ready_dict[ready_ids[i]][0])
#     destination_back.append(ready_dict[ready_ids[i]][-1])

for i in range(len(ready_ids)):
    destination_front.append(str(ready_ids[i]))
    destination_back.append(str(ready_ids[i]))
    destination_back.append(str(ready_ids[i]))
    
a1 = [yoga, holiday_word1, holiday_word2, destination_back]
a2 = [destination_front, yoga, holiday_word1, holiday_word2]

import itertools

comb = list(itertools.product(*a1))
comb2 = list(itertools.product(*a2))

for i in range(len(comb)):
    if comb[i][1] == comb[i][2]:
        comb[i] = (comb[i][0], comb[i][1], comb[i][3])
    elif comb[i][1]+'s' == comb[i][2]:
        comb[i] = (comb[i][0], comb[i][1], comb[i][3])
    elif comb[i][1] == comb[i][2]+'s':
        comb[i] = (comb[i][0], comb[i][1], comb[i][3])
    
for i in range(len(comb2)):
    if comb2[i][2] == comb2[i][3]:
        comb2[i] = (comb2[i][0], comb2[i][1], comb2[i][2])
    elif comb2[i][2]+'s' == comb2[i][3]:
        comb2[i] = (comb2[i][0], comb2[i][1], comb2[i][2])
    elif comb2[i][2] == comb2[i][3]+'s':
        comb2[i] = (comb2[i][0], comb2[i][1], comb2[i][2])
        
results = []

kw_campaign = []
kw_ad_group = []

keyword_max_cpc = []

for i in range(len(comb)):
    if ready_dict[int(comb[i][-1])][1] == 'state':
        kw_campaign.append("Longtail %s - %s" %(ready_dict[int(comb[i][-1])][-2], ready_dict[int(comb[i][-1])][0]))
        kw_ad_group.append("Longtail Retreats %s" %ready_dict[int(comb[i][-1])][0])

    elif ready_dict[int(comb[i][-1])][1] == 'country':
        kw_campaign.append("Longtail %s" %ready_dict[int(comb[i][-1])][0])
        kw_ad_group.append("Longtail Retreats %s" %ready_dict[int(comb[i][-1])][0])
    
    if ready_dict[int(comb[i][-1])][2] < 6:
        keyword_max_cpc.append(0.20)
    elif ready_dict[int(comb[i][-1])][2] < 11:
        keyword_max_cpc.append(0.25)
    elif ready_dict[int(comb[i][-1])][2] < 21:
        keyword_max_cpc.append(0.30)
    elif ready_dict[int(comb[i][-1])][2] < 31:
        keyword_max_cpc.append(0.35)
    elif ready_dict[int(comb[i][-1])][2] < 41:
        keyword_max_cpc.append(0.40)
    elif ready_dict[int(comb[i][-1])][2] < 51:
        keyword_max_cpc.append(0.45)
    elif ready_dict[int(comb[i][-1])][2] < 101:
        keyword_max_cpc.append(0.50)
    elif ready_dict[int(comb[i][-1])][2] < 151:
        keyword_max_cpc.append(0.55)
    elif ready_dict[int(comb[i][-1])][2] < 201:
        keyword_max_cpc.append(0.60)
    elif ready_dict[int(comb[i][-1])][2] < 251:
        keyword_max_cpc.append(0.70)
    elif ready_dict[int(comb[i][-1])][2] < 301:
        keyword_max_cpc.append(0.80)
    elif ready_dict[int(comb[i][-1])][2] < 501:
        keyword_max_cpc.append(0.90)
    else:
        keyword_max_cpc.append(0.90)

    comb[i] = list(comb[i])
    
    if i%2 == 1: #odd
        comb[i][-1] = ready_dict[int(comb[i][-1])][-1] #id -> name
    if i%2 == 0: #even
        comb[i][-1] = ready_dict[int(comb[i][-1])][0] #id -> name

    comb[i] = tuple(x for x in comb[i] if x != '')
    comb[i] = '[' + (' '.join(comb[i])) + ']'

for i in range(len(comb2)):
    if ready_dict[int(comb2[i][0])][1] == 'state':
        kw_campaign.append("Longtail %s - %s" %(ready_dict[int(comb2[i][0])][-2], ready_dict[int(comb2[i][0])][0]))
        kw_ad_group.append("Longtail Retreats %s" %ready_dict[int(comb2[i][0])][0])
        
    elif ready_dict[int(comb2[i][0])][1] == 'country':
        kw_campaign.append("Longtail %s" %ready_dict[int(comb2[i][0])][0])
        kw_ad_group.append("Longtail Retreats %s" %ready_dict[int(comb2[i][0])][0])
        
    if ready_dict[int(comb2[i][0])][2] < 6:
        keyword_max_cpc.append(0.20)
    elif ready_dict[int(comb2[i][0])][2]< 11:
        keyword_max_cpc.append(0.25)
    elif ready_dict[int(comb2[i][0])][2] < 21:
        keyword_max_cpc.append(0.30)
    elif ready_dict[int(comb2[i][0])][2] < 31:
        keyword_max_cpc.append(0.35)
    elif ready_dict[int(comb2[i][0])][2] < 41:
        keyword_max_cpc.append(0.40)
    elif ready_dict[int(comb2[i][0])][2] < 51:
        keyword_max_cpc.append(0.45)
    elif ready_dict[int(comb2[i][0])][2] < 101:
        keyword_max_cpc.append(0.50)
    elif ready_dict[int(comb2[i][0])][2] < 151:
        keyword_max_cpc.append(0.55)
    elif ready_dict[int(comb2[i][0])][2] < 201:
        keyword_max_cpc.append(0.60)
    elif ready_dict[int(comb2[i][0])][2] < 251:
        keyword_max_cpc.append(0.70)
    elif ready_dict[int(comb2[i][0])][2] < 301:
        keyword_max_cpc.append(0.80)
    elif ready_dict[int(comb2[i][0])][2] < 501:
        keyword_max_cpc.append(0.90)
    else:
        keyword_max_cpc.append(0.90)
        
    comb2[i] = list(comb2[i])
    
    comb2[i][0] = ready_dict[int(comb2[i][0])][0]

    comb2[i] = tuple(x for x in comb2[i] if x != '')
    comb2[i] = '[' + (' '.join(comb2[i])) +']'
    
results = comb + comb2

ad_group_max_cpc = [0.10]
keyword_state = ['enabled'] * len(results)
match_type = ['Exact'] * len(results)
ad_group_max_cpc = ad_group_max_cpc * len(results)

kw_column_titles = ['Keyword state',
                   'Keyword',
                   'Match type',
                   'Campaign',
                   'Ad group',
                   'Keyword max CPC',
                   'Ad group max CPC']

kw_rows = []
for i in range(len(results)):
    kw_rows.append([keyword_state[i],
                  results[i],
                  match_type[i],
                  kw_campaign[i],
                  kw_ad_group[i],
                  keyword_max_cpc[i],
                  ad_group_max_cpc[i]])
    
for i in range(len(kw_rows)):
    kw_rows[i] = tuple(kw_rows[i])
    
kw_rows = set(kw_rows)

export_name = 'SQL KWs.csv'
new_export = open(export_name, 'w')
export_object = csv.writer(new_export)

export_object.writerow(kw_column_titles)
export_object.writerows(kw_rows)

new_export.close()

print('%i keywords for %i destinations have been created please check your current directory for the csv output' %(len(kw_rows), len(ready_urls)))



#########################################################################################

#1. open campaigns

#!/usr/bin/python
#
# Copyright 2016 Google Inc. All Rights Reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

"""This example adds campaigns.

To get campaigns, run get_campaigns.py.

The LoadFromStorage method is pulling credentials and properties from a
"googleads.yaml" file. By default, it looks for this file in your home
directory. For more information, see the "Caching authentication information"
section of our README.

"""

import datetime
import uuid
from googleads import adwords

camps = sorted(list(set(kw_campaign))) #campaign names
groups = sorted(list(set(kw_ad_group))) #ad group names
campaign_ids = [] #campaign id storage for later
campaign_names = [] #campaign name storage for later
ad_group_ids = [] #ad group id storage for later
ad_group_names = []#ad group name storage for later

if __name__ == '__main__':
  
  # Initialize client object.
  adwords_client = adwords.AdWordsClient.LoadFromStorage()

  client = adwords_client

  campaign_service = client.GetService('CampaignService', version='v201603')
  budget_service = client.GetService('BudgetService', version='v201603')

  for i in range(len(camps)):
    
    # Create a budget, which can be shared by multiple campaigns.
    budget = {
        'name': 'Budget #%s' % uuid.uuid4(),
        #'name': '100 %s' % float(i/100),
        'amount': {
            'microAmount': '100000000' #100 euros
        },
        'deliveryMethod': 'STANDARD'
    }

    budget_operations = [{
        'operator': 'ADD',
        'operand': budget
    }]

    # Add the budget.
    budget_id = budget_service.mutate(budget_operations)['value'][0][
        'budgetId']

    # Construct operations and add campaigns.
    operations = [{
        'operator': 'ADD',
        'operand': {
            #'name': 'Interplanetary Cruise #%s' % uuid.uuid4(),
            'name': '%s' % camps[i],
            'status': 'ENABLED',
            'advertisingChannelType': 'SEARCH',
            'biddingStrategyConfiguration': {
                'biddingStrategyType': 'MANUAL_CPC',
            },
            'endDate': (datetime.datetime.now() +
                        datetime.timedelta(365)).strftime('20371230'),
            # Note that only the budgetId is required
            'budget': {
                'budgetId': budget_id
            },
            'networkSetting': {
                'targetGoogleSearch': 'true',
                'targetSearchNetwork': 'true',
                'targetContentNetwork': 'false',
                'targetPartnerSearchNetwork': 'false'
            },
            # Optional fields
            'startDate': (datetime.datetime.now() +
                          datetime.timedelta(1)).strftime('%Y%m%d'),
            'adServingOptimizationStatus': 'ROTATE',
            'frequencyCap': {
                'impressions': '5',
                'timeUnit': 'DAY',
                'level': 'ADGROUP'
            },
            'settings': [
                {
                    'xsi_type': 'GeoTargetTypeSetting',
                    'positiveGeoTargetType': 'DONT_CARE',
                    'negativeGeoTargetType': 'DONT_CARE'
                }
            ]
        }
    }]

    campaigns = campaign_service.mutate(operations)

    # Display results.
    for campaign in campaigns['value']:
      print ('Campaign with name \'%s\' and id \'%s\' was added.'
             % (campaign['name'], campaign['id']))

#########################################################################

#2. get campaigns + open ad groups

#!/usr/bin/python
#
# Copyright 2016 Google Inc. All Rights Reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

"""This example gets all campaigns.

To add a campaign, run add_campaign.py.

The LoadFromStorage method is pulling credentials and properties from a
"googleads.yaml" file. By default, it looks for this file in your home
directory. For more information, see the "Caching authentication information"
section of our README.

"""

import logging
import time
from googleads import adwords

logging.basicConfig(level=logging.INFO)
logging.getLogger('suds.transport').setLevel(logging.DEBUG)


PAGE_SIZE = 100


def main(client):
  # Initialize appropriate service.
  campaign_service = client.GetService('CampaignService', version='v201603')

  # Construct selector and get all campaigns.
  offset = 0
  selector = {
      'fields': ['Id', 'Name', 'Status'],
      'paging': {
          'startIndex': str(offset),
          'numberResults': str(PAGE_SIZE)
      }
  }

  more_pages = True
  while more_pages:
    page = campaign_service.get(selector)

    # Display results.
    if 'entries' in page:
      for campaign in page['entries']:
        print ('Campaign with id \'%s\', name \'%s\', and status \'%s\' was '
               'found.' % (campaign['id'], campaign['name'],
                           campaign['status']))
        campaign_ids.append(str(campaign['id']))
        campaign_names.append(str(campaign['name'])[9:])


    else:
      print ('No campaigns were found.')
    offset += PAGE_SIZE
    selector['paging']['startIndex'] = str(offset)
    more_pages = offset < int(page['totalNumEntries'])
    time.sleep(1)


if __name__ == '__main__':
  adwords_client = adwords.AdWordsClient.LoadFromStorage()
  main(adwords_client)


  # Initialize appropriate service.
  ad_group_service = client.GetService('AdGroupService', version='v201603')

  for i in range(len(camps)):
    #destination = ' %s' %campaign_names[i]
    campaign_id = campaign_ids[i]

    operations = [{
      'operator': 'ADD',
      'operand': {
          'campaignId': campaign_id,
          #'name': 'Earth to Mars Cruises #%s' % uuid.uuid4(),
          'name': '%s' %ad_group_name,
          #'label': 'type=dest' .  
          'status': 'ENABLED',
          'biddingStrategyConfiguration': {
              'bids': [
                  {
                      'xsi_type': 'CpcBid',
                      'bid': {
                          'microAmount': '1000000'
                      },
                  }
              ]
          },
          'settings': [
              {
                  # Targeting restriction settings. Depending on the
                  # criterionTypeGroup value, most TargetingSettingDetail only
                  # affect Display campaigns. However, the
                  # USER_INTEREST_AND_LIST value works for RLSA campaigns -
                  # Search campaigns targeting using a remarketing list.
                  'xsi_type': 'TargetingSetting',
                  'details': [
                      # Restricting to serve ads that match your ad group
                      # placements. This is equivalent to choosing
                      # "Target and bid" in the UI.
                      {
                          'xsi_type': 'TargetingSettingDetail',
                          'criterionTypeGroup': 'PLACEMENT',
                          'targetAll': 'false',
                      },
                      # Using your ad group verticals only for bidding. This is
                      # equivalent to choosing "Bid only" in the UI.
                      {
                          'xsi_type': 'TargetingSettingDetail',
                          'criterionTypeGroup': 'VERTICAL',
                          'targetAll': 'true',
                      },
                  ]
              }
          ]
      }
    }]

    ad_groups = ad_group_service.mutate(operations)

    # Display results.
    for ad_group in ad_groups['value']:
        print ('Ad group with name \'%s\' and id \'%s\' was added.'
               % (ad_group['name'], ad_group['id']))



print (campaign_ids)

#########################################################################

#3. get ad groups

from googleads import adwords

PAGE_SIZE = 500

ad_group_service = client.GetService('AdGroupService', version='v201603')


for i in range(len(campaign_ids)):

  campaign_id = campaign_ids[i]

  offset = 0
  selector = {
    'fields': ['Id', 'Name', 'Status'],
    'predicates': [
        {
            'field': 'CampaignId',
            'operator': 'EQUALS',
            'values': [campaign_id]
        }
    ],
    'paging': {
        'startIndex': str(offset),
        'numberResults': str(PAGE_SIZE)
    }
}
more_pages = True
while more_pages:
  page = ad_group_service.get(selector)

  # Display results.
  if 'entries' in page:
    for ad_group in page['entries']:
      print ('Ad group with name \'%s\', id \'%s\' and status \'%s\' was '
             'found.' % (ad_group['name'], ad_group['id'],
                         ad_group['status']))
      ad_group_names.append(ad_group['name'])
      ad_group_ids.append(ad_group['id'])

  else:
    print ('No ad groups were found.')

  offset += PAGE_SIZE
  selector['paging']['startIndex'] = str(offset)
  more_pages = offset < int(page['totalNumEntries'])

#########################################################################
